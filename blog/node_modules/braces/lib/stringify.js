'use strict';

const utils = require('./utils');

module.exports = (ast, options = {}) => {
<<<<<<< HEAD
  const stringify = (node, parent = {}) => {
    const invalidBlock = options.escapeInvalid && utils.isInvalidBrace(parent);
    const invalidNode = node.invalid === true && options.escapeInvalid === true;
=======
  let stringify = (node, parent = {}) => {
    let invalidBlock = options.escapeInvalid && utils.isInvalidBrace(parent);
    let invalidNode = node.invalid === true && options.escapeInvalid === true;
>>>>>>> b047c7af968c2defde288ca932b322a98c4a7fc4
    let output = '';

    if (node.value) {
      if ((invalidBlock || invalidNode) && utils.isOpenOrClose(node)) {
        return '\\' + node.value;
      }
      return node.value;
    }

    if (node.value) {
      return node.value;
    }

    if (node.nodes) {
<<<<<<< HEAD
      for (const child of node.nodes) {
=======
      for (let child of node.nodes) {
>>>>>>> b047c7af968c2defde288ca932b322a98c4a7fc4
        output += stringify(child);
      }
    }
    return output;
  };

  return stringify(ast);
};

